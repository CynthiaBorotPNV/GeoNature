<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gestion de la sensibilité &mdash; Documentation GeoNature 2.0</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="index.html" class="icon icon-home"> GeoNature
            <img src="_static/LogoGeonature.jpg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">INSTALLATION</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-manual.html">MANUEL UTILISATEUR</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin-manual.html">MANUEL ADMINISTRATEUR</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">DEVELOPPEMENT</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">AUTEURS</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">CHANGELOG</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GeoNature</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Gestion de la sensibilité</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/sensitivity.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gestion-de-la-sensibilite">
<h1>Gestion de la sensibilité<a class="headerlink" href="#gestion-de-la-sensibilite" title="Lien permanent vers cette rubrique"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Lien permanent vers cette rubrique"></a></h2>
<p>Les régles de sensibilité définies par défaut sont issues des règles du SINP.
Elles dépendent de l’espèce et de l’observation. C’est-à-dire que pour une espèce donnée,
plusieurs niveaux de sensibilité sont possibles selon l’observation.</p>
<section id="criteres-de-sensibilite">
<h3>Critères de sensibilité<a class="headerlink" href="#criteres-de-sensibilite" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p>Taxon</p></li>
<li><p>Emplacement</p></li>
<li><p>Ancienneté</p></li>
<li><p>Période de l’année</p></li>
<li><p>Statut biologique</p></li>
<li><p>Comportement de l’occurence</p></li>
</ul>
<p>Certaines règles de sensibilité peuvent porter uniquement sur l’espèce,
rendant l’entiereté des observations d’une espèce (et donc une espèce) sensible.</p>
</section>
<section id="niveaux-de-sensibilite">
<h3>Niveaux de sensibilité<a class="headerlink" href="#niveaux-de-sensibilite" title="Lien permanent vers cette rubrique"></a></h3>
<p>Voici les 5 niveaux de sensibilité définis par le SINP :</p>
<ul class="simple">
<li><p>Sensible - Aucune diffusion</p></li>
<li><p>Sensible - Diffusion au département</p></li>
<li><p>Sensible - Diffusion à la maille 10km</p></li>
<li><p>Sensible - Diffusion à la Commune ou Znieff</p></li>
<li><p>Non sensible - Diffusion précise</p></li>
</ul>
</section>
<section id="pour-plus-d-informations">
<h3>Pour plus d’informations<a class="headerlink" href="#pour-plus-d-informations" title="Lien permanent vers cette rubrique"></a></h3>
<p>Vous pouvez consulter :</p>
<ul class="simple">
<li><p>La page du site du <a class="reference external" href="https://inpn.mnhn.fr/programme/donnees-observations-especes/references/sensibilite">SINP traitant de la sensibilité</a>.</p></li>
<li><p>Le rapport de 2020 sur <a class="reference external" href="https://inpn.mnhn.fr/docs-web/docs/download/355449">La sensibilité des données du système  d’information  de l’inventaire  du  patrimoine naturel : méthodes, pratiques et usages (J. Ichter et S. Robert)</a>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>L’objectif de ce document n’est pas de modifier les règles établies par
le SINP. Il est donc conseillé de respecter ces règles définies au niveau
régional et national et donc de ne pas ajouter de règles locales.</p>
</div>
</section>
</section>
<section id="integration-dans-geonature">
<h2>Intégration dans GeoNature<a class="headerlink" href="#integration-dans-geonature" title="Lien permanent vers cette rubrique"></a></h2>
<section id="stockage-des-regles-en-base">
<h3>Stockage des règles en base<a class="headerlink" href="#stockage-des-regles-en-base" title="Lien permanent vers cette rubrique"></a></h3>
<p>Les règles de sensibilité sont stockées dans le schéma <code class="docutils literal notranslate"><span class="pre">gn_sensitivity</span></code>
qui contient 3 tables :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t_sensitivity_rules</span></code> qui relie notamment une espèce à un niveau de
sensibilité</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cor_sensitivity_criteria</span></code> qui permet de restreindre une règle de
sensibilité en fonction d’un critère (par exemple, statut biologique)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cor_sensitivity_area</span></code> qui permet de restreindre une règle de
sensibilité à une zone géographique</p></li>
</ul>
<p>S’il n’y a aucune entrée dans <code class="docutils literal notranslate"><span class="pre">cor_sensitivity_criteria</span></code>, le niveau de
sensibilité défini dans <code class="docutils literal notranslate"><span class="pre">t_sensitivity_rules</span></code> est appliqué peu importe
le statut biologique ou le comportement de l’occurence.
De même, s’il n’y a aucune entrée dans <code class="docutils literal notranslate"><span class="pre">cor_sensitivity_area</span></code>, le niveau
de sensibilité est appliqué peu importe la localisation de l’observation.
À l’inverse, s’il y a plusieurs entrées, la sensibilité est appliqué dès
que l’un des critères ou l’une des zones correspond à l’observation.</p>
<p>Certaines règles sont définies non pas pour une espèce donnée mais pour un
rang supérieur. Ces règles sont artificiellement dupliquées pour chaques espèces
sous-jacentes dans la vue matérialisée <code class="docutils literal notranslate"><span class="pre">t_sensitivity_rules_cd_ref</span></code>.
Il est nécessaire de la rafraichir lors de l’évolution du référentiel
de sensibilité.</p>
</section>
<section id="attribution-aux-observations-de-la-synthese">
<h3>Attribution aux observations de la synthèse<a class="headerlink" href="#attribution-aux-observations-de-la-synthese" title="Lien permanent vers cette rubrique"></a></h3>
<p>La sensibilité des observations de la synthèse est stockée dans la
colonne <code class="docutils literal notranslate"><span class="pre">id_nomenclature_sensitivity</span></code>.</p>
<p>A chaque insertion d’une donnée dans la table <code class="docutils literal notranslate"><span class="pre">gn_synthese.synthese</span></code>,
un trigger (<code class="docutils literal notranslate"><span class="pre">tri_insert_calculate_sensitivity</span></code>) fait appel à une
fonction (<code class="docutils literal notranslate"><span class="pre">fct_tri_cal_sensitivity_on_each_statement</span></code>) qui appelle
elle-même la fonction <code class="docutils literal notranslate"><span class="pre">gn_sensitivity.get_id_nomenclature_sensitivity</span></code>
pour le calcul de la sensibilité.</p>
</section>
<section id="gestion-du-referentiel">
<h3>Gestion du référentiel<a class="headerlink" href="#gestion-du-referentiel" title="Lien permanent vers cette rubrique"></a></h3>
<p>GeoNature fournit la commande <code class="docutils literal notranslate"><span class="pre">geonature</span> <span class="pre">sensitivity</span></code> pour gérer son référentiel
de sensibilité :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">geonature</span> <span class="pre">sensitivity</span> <span class="pre">info</span></code> : statistiques sur les règles présentes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geonature</span> <span class="pre">sensitivity</span> <span class="pre">add-referential</span></code> : import de nouvelles règles</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geonature</span> <span class="pre">sensitivity</span> <span class="pre">remove-referential</span></code> : suppression de règles</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geonature</span> <span class="pre">sensitivity</span> <span class="pre">refresh-rules-cache</span></code> : mise à jour de la vue matérialisées des règles</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geonature</span> <span class="pre">sensitivity</span> <span class="pre">update-synthese</span></code> : recalcul de la sensibilité des observations de la synthèse</p></li>
</ul>
<p>Le référentiel de sensibilité fourni par le SINP est normalement intégré
à GeoNature lors de son installation. Sinon, il peut être manuellement
intégré avec l’une ou l’autre des commandes suivantes :</p>
<p>TaxRef v16 :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>geonature sensitivity add-referential <span class="se">\</span>
        --source-name <span class="s2">&quot;Référentiel sensibilité TAXREF v16 20230203&quot;</span> <span class="se">\</span>
        --url https://geonature.fr/data/inpn/sensitivity/RefSensibiliteV16_20230203.zip <span class="se">\</span>
        --zipfile RefSensibiliteV16_20230203.zip <span class="se">\</span>
        --csvfile RefSensibiliteV16_20230203/RefSensibilite_16.csv  <span class="se">\</span>
        --encoding<span class="o">=</span>iso-8859-15
</pre></div>
</div>
<p>TaxRef v15 :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>geonature sensitivity add-referential <span class="se">\</span>
        --source-name <span class="s2">&quot;Référentiel sensibilité TAXREF v15 20220331&quot;</span> <span class="se">\</span>
        --url https://inpn.mnhn.fr/docs-web/docs/download/401875 <span class="se">\</span>
        --zipfile RefSensibiliteV15_20220331.zip <span class="se">\</span>
        --csvfile RefSensibilite_V15_31032022/RefSensibilite_15.csv  <span class="se">\</span>
        --encoding<span class="o">=</span>iso-8859-15
</pre></div>
</div>
<p>TaxRef v14 :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>geonature sensitivity add-referential <span class="se">\</span>
        --source-name <span class="s2">&quot;Référentiel sensibilité TAXREF v14 20220331&quot;</span> <span class="se">\</span>
        --url https://inpn.mnhn.fr/docs-web/docs/download/401876 <span class="se">\</span>
        --zipfile RefSensibiliteV14_20220331.zip <span class="se">\</span>
        --csvfile RefSensibilite_V14_31032022/RefSensibilite_14.csv  <span class="se">\</span>
        --encoding<span class="o">=</span>iso-8859-15
</pre></div>
</div>
<p>Le jeu de règles est fourni pour chaque version précise de TaxRef, certaines
espèces sensibles pouvant voir leur <em>cd_nom</em> changé d’une version à l’autre.</p>
</section>
<section id="personnalisation">
<h3>Personnalisation<a class="headerlink" href="#personnalisation" title="Lien permanent vers cette rubrique"></a></h3>
<p>Pour l’instant, seule la personnalisation de la sensibilité pour
une espèce donnée (peu importe l’observation) est abordée ici.</p>
<ol class="arabic">
<li><p>Dans <code class="docutils literal notranslate"><span class="pre">gn_sensitivity.t_sensitivity_rules</span></code> : Changez le niveau de
sensibilité <code class="docutils literal notranslate"><span class="pre">id_nomenclature_sensitivity</span></code> par celui désiré. Pour la
valeur à renseigner, voir dans <code class="docutils literal notranslate"><span class="pre">t_nomenclature</span></code> en filtrant avec
<code class="docutils literal notranslate"><span class="pre">id_type=ref_nomenclatures.get_id_nomenclature_type('SENSIBILITE')</span></code>.</p></li>
<li><p>Dans <code class="docutils literal notranslate"><span class="pre">cor_sensitivity_criteria</span></code> : s’il y a une correspondance
d”<code class="docutils literal notranslate"><span class="pre">id_sensitivity</span></code> avec <code class="docutils literal notranslate"><span class="pre">t_sensitivity_rules</span></code>, modifiez ou supprimez cette ligne.</p></li>
<li><p>Rafraichissez le cache des règles extrapolées aux espèces :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>geonature sensitivity refresh-rules-cache
</pre></div>
</div>
<p>Ceci est équivalent à lancer manuellement la commande SQL suivante :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">REFRESH</span><span class="w"> </span><span class="n">MATERIALIZED</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">gn_sensitivity</span><span class="p">.</span><span class="n">t_sensitivity_rules_cd_ref</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>Il est maintenant nécessaire de mettre à jour la sensibilité de vos
observations présentes dans la synthèse. Pour cela, lancez la commande suivante :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>geonature sensitivity update-synthese
</pre></div>
</div>
</li>
</ol>
<p>Les valeurs dans la colonne <code class="docutils literal notranslate"><span class="pre">id_nomenclature_sensitivity</span></code> des observations sensibles
de la table <code class="docutils literal notranslate"><span class="pre">gn_synthese.synthese</span></code> auront alors
changé. Vous pouvez le vérifier en navigant dans le module Synthèse
puis dans les détails d’une observation de votre/vos espèce(s).</p>
</section>
<section id="utilisation">
<h3>Utilisation<a class="headerlink" href="#utilisation" title="Lien permanent vers cette rubrique"></a></h3>
<p>Actuellement, le niveau de sensibilité des observations n’est pas exploité par GeoNature.
Le floutage des observations en fonction de leur niveau de sensibilité est une fonctionnalité
souhaitée mais pas encore présente dans GeoNature.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2023, PnE, PnC.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>